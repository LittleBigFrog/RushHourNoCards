<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rush Hour Puzzle Collection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
    // Inline script to ensure React 18 rendering
    const { createRoot } = ReactDOM;
    const root = createRoot(document.getElementById('root'));
    
    // Global processDatabase function
    function processDatabase(data) {
      const db = {};
      data.m.forEach(moves => {
        db[moves] = [];
      });
      data.p.forEach(([moveIdx, board, cluster]) => {
        db[data.m[moveIdx]].push({
          board: board,
          clusterSize: cluster
        });
      });
      return db;
    }

    // Main App Component
    const RushHourApp = () => {
      const [puzzlesByMoves, setPuzzlesByMoves] = React.useState(null);
      const [loading, setLoading] = React.useState(true);

      React.useEffect(() => {
        console.log('Loading database...');
        fetch('./rush_no_walls.json?v=' + new Date().getTime())
          .then(response => {
            console.log('Response status:', response.status);
            return response.json();
          })
          .then(data => {
            console.log('Parsed JSON:', data);
            const processedData = processDatabase(data);
            setPuzzlesByMoves(processedData);
            setLoading(false);
          })
          .catch(error => {
            console.error('Error loading database:', error);
            document.getElementById('root').innerHTML = `
              <div style="color:red; padding:20px; text-align:center;">
                Error loading database: ${error.message}
                <br>
                Check console for details
              </div>
            `;
            setLoading(false);
          });
      }, []);

      // Existing component logic here...
      if (loading) {
        return <div className="text-center p-8">Loading puzzle database...</div>;
      }

      // Placeholder for the rest of your existing component
      return (
        <div className="min-h-screen bg-gray-100 py-6 flex flex-col justify-center sm:py-12">
          <div>Rush Hour Puzzle Loaded Successfully</div>
        </div>
      );
    };

    // Render the app
    root.render(<RushHourApp />);
    </script>
</body>
</html>
